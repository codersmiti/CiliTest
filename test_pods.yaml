apiVersion: v1
kind: Namespace
metadata:
  name: cilium-test
---
# ðŸŸ¢ FRONTEND (acts as client)
apiVersion: v1
kind: Pod
metadata:
  name: frontend
  namespace: cilium-test
  labels:
    app: frontend
spec:
  containers:
    - name: frontend
      image: registry.k8s.io/e2e-test-images/agnhost:2.45
      args: ["netexec", "--http-port=80"]
---
apiVersion: v1
kind: Service
metadata:
  name: frontend
  namespace: cilium-test
spec:
  selector:
    app: frontend
  ports:
    - port: 80
      targetPort: 80
---
# ðŸŸ£ BACKEND (listens on port 80)
apiVersion: v1
kind: Pod
metadata:
  name: backend
  namespace: cilium-test
  labels:
    app: backend
spec:
  containers:
    - name: backend
      image: registry.k8s.io/e2e-test-images/agnhost:2.45
      args: ["netexec", "--http-port=80"]
---
apiVersion: v1
kind: Service
metadata:
  name: backend
  namespace: cilium-test
spec:
  selector:
    app: backend
  ports:
    - port: 80
      targetPort: 80
---
# ðŸ”µ DATABASE (listens on port 5432)
apiVersion: v1
kind: Pod
metadata:
  name: database
  namespace: cilium-test
  labels:
    app: database
spec:
  containers:
    - name: database
      image: registry.k8s.io/e2e-test-images/agnhost:2.45
      args: ["netexec", "--http-port=5432"]
---
apiVersion: v1
kind: Service
metadata:
  name: database
  namespace: cilium-test
spec:
  selector:
    app: database
  ports:
    - port: 5432
      targetPort: 5432
---
# ðŸŸ  CACHE (listens on port 6379)
apiVersion: v1
kind: Pod
metadata:
  name: cache
  namespace: cilium-test
  labels:
    app: cache
spec:
  containers:
    - name: cache
      image: registry.k8s.io/e2e-test-images/agnhost:2.45
      args: ["netexec", "--http-port=6379"]
---
apiVersion: v1
kind: Service
metadata:
  name: cache
  namespace: cilium-test
spec:
  selector:
    app: cache
  ports:
    - port: 6379
      targetPort: 6379
